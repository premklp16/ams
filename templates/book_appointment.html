<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{
      font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
      background:#f5f5f5;min-height:100vh;padding:20px;
    }
    .container{max-width:1200px;margin:0 auto;}
    .card{
      background:white;border-radius:12px;padding:30px;
      margin:20px auto;max-width:100%;
      box-shadow:0 10px 40px rgba(0,0,0,0.1);
    }
    .header{
      background:white;border-radius:12px;padding:20px;
      margin-bottom:20px;display:flex;justify-content:space-between;
      align-items:center;
    }
    .user-info h2{color:#333;font-size:20px;margin-bottom:5px;}
    .user-info p{color:#666;font-size:14px;}
    .btn{
      padding:8px 16px;background:#667eea;color:white;border:none;
      border-radius:6px;font-size:14px;font-weight:600;
      cursor:pointer;transition:background 0.3s;
    }
    .btn:hover{background:#5568d3;}
    .btn-secondary{background:#6c757d;}
    .btn-secondary:hover{background:#5a6268;}
    .btn-success{background:#28a745;}
    .btn-success:hover{background:#218838;}
    .dashboard-grid{
      display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));
      gap:20px;margin-top:20px;
    }
    .step-header{
      font-weight:600;color:#333;margin-bottom:15px;
      display:flex;justify-content:space-between;align-items:center;
    }
    .grid-2{
      display:grid;grid-template-columns:repeat(2,1fr);gap:10px;
    }
    .department-btn,.doctor-btn,.time-slot-btn{
      padding:15px;background:white;border:2px solid #ddd;border-radius:8px;
      cursor:pointer;transition:all 0.3s;text-align:left;
    }
    .department-btn:hover,.doctor-btn:hover{
      border-color:#667eea;transform:translateY(-2px);
    }
    .department-btn.selected,.doctor-btn.selected{
      border-color:#667eea;background:#667eea;color:white;
    }
    .time-slot-btn{text-align:center;padding:10px;}
    .time-slot-btn:disabled{
      opacity:0.5;cursor:not-allowed;background:#f0f0f0;
    }
    .time-slot-btn.selected{
      background:#667eea;color:white;border-color:#667eea;
    }
    .form-group{margin-bottom:20px;}
    input[type="date"]{
      width:100%;padding:12px;border:1px solid #ddd;
      border-radius:6px;font-size:14px;
    }
    .appointment-card{
      background:#f8f9fa;padding:15px;border-radius:8px;
      margin-bottom:15px;border-left:4px solid #667eea;
    }
    .appointment-card h3{color:#333;margin-bottom:10px;}
    .appointment-card p{color:#666;font-size:14px;margin:5px 0;}
    table{
      width:100%;border-collapse:collapse;margin-top:20px;
    }
    th,td{
      padding:12px;text-align:left;border-bottom:1px solid #ddd;
    }
    th{background:#667eea;color:white;}
    .slot-booked{
      background:#28a745;color:white;padding:5px 10px;border-radius:4px;
    }
    .slot-empty{color:#999;}
    .toast{
      position:fixed;top:20px;right:20px;background:white;
      padding:15px 20px;border-radius:8px;
      box-shadow:0 4px 12px rgba(0,0,0,0.15);z-index:1000;
      animation:slideIn 0.3s ease;
    }
    .toast.success{border-left:4px solid #28a745;}
    .toast.error{border-left:4px solid #dc3545;}
    @keyframes slideIn{
      from{transform:translateX(400px);opacity:0;}
      to{transform:translateX(0);opacity:1;}
    }
  </style>
</head>
<body>
  <div class="container" id="patient-dashboard" style="display:none;">
    <div class="header">
      <div class="user-info">
        <h2 id="patient-name"></h2>
        <p id="patient-phone"></p>
      </div>
      <div>
        <button class="btn-secondary btn" onclick="logoutPatient()">Logout</button>
      </div>
    </div>

    <div class="dashboard-grid">
      <div class="card">
        <h2 style="margin-bottom:20px;">ðŸ“… Book New Appointment</h2>
        <div id="step-1">
          <div class="step-header">
            <span>Step 1: Select Department</span>
            <button class="btn btn-secondary" onclick="resetBooking()" style="display:none;" id="reset-btn">Reset</button>
          </div>
          <div class="grid-2" id="departments-grid"></div>
        </div>
        <div id="step-2" style="margin-top:20px;display:none;">
          <div class="step-header">Step 2: Select Doctor</div>
          <div id="doctors-list"></div>
        </div>
        <div id="step-3" style="margin-top:20px;display:none;">
          <div class="step-header">Step 3: Select Date</div>
          <input type="date" id="appointment-date" class="form-group" style="margin:0;">
        </div>
        <div id="step-4" style="margin-top:20px;display:none;">
          <div class="step-header">Step 4: Select Time Slot</div>
          <div class="grid-2" id="time-slots-grid"></div>
          <button class="btn btn-success" id="book-btn" onclick="bookAppointment()" style="margin-top:15px;display:none;">ðŸ“… Book Appointment</button>
        </div>
      </div>

      <div class="card">
        <h2 style="margin-bottom:20px;">My Appointments</h2>
        <div id="appointments-list"></div>
      </div>
    </div>
  </div>

  <div class="container" id="doctor-dashboard" style="display:none;">
    <div class="header">
      <div class="user-info">
        <h2 id="doctor-name"></h2>
        <p id="doctor-dept"></p>
      </div>
      <div>
        <button class="btn-secondary btn" onclick="logoutDoctor()">Logout</button>
      </div>
    </div>
    <div class="card">
      <h2 style="margin-bottom:20px;">ðŸ“… Today's Appointments</h2>
      <table>
        <thead>
          <tr>
            <th>Time Slot</th>
            <th>Patient Name</th>
            <th>Phone Number</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody id="doctor-appointments-body"></tbody>
      </table>
    </div>
  </div>

  <script>
    const DEPARTMENTS=['Cardiology','Neurology','Orthopedics','Pediatrics'];
    const DOCTORS=[
      { id:'dr1',name:'Dr. Sarah Johnson',department:'Cardiology',specialization:'Heart Disease' },
      { id:'dr2',name:'Dr. Michael Chen',department:'Cardiology',specialization:'Cardiac Surgery' },
      { id:'dr3',name:'Dr. Emily Davis',department:'Cardiology',specialization:'Interventional Cardiology' },
      { id:'dr4',name:'Dr. James Wilson',department:'Cardiology',specialization:'Electrophysiology' },
      { id:'dr5',name:'Dr. Robert Martinez',department:'Neurology',specialization:'Brain Disorders' },
      { id:'dr6',name:'Dr. Lisa Anderson',department:'Neurology',specialization:'Stroke Care' },
      { id:'dr7',name:'Dr. David Thompson',department:'Neurology',specialization:'Epilepsy' },
      { id:'dr8',name:'Dr. Maria Garcia',department:'Neurology',specialization:'Movement Disorders' },
      { id:'dr9',name:'Dr. John Taylor',department:'Orthopedics',specialization:'Joint Replacement' },
      { id:'dr10',name:'Dr. Jennifer Lee',department:'Orthopedics',specialization:'Sports Medicine' },
      { id:'dr11',name:'Dr. William Brown',department:'Orthopedics',specialization:'Spine Surgery' },
      { id:'dr12',name:'Dr. Patricia Moore',department:'Orthopedics',specialization:'Trauma Surgery' },
      { id:'dr13',name:'Dr. Christopher White',department:'Pediatrics',specialization:'Child Development' },
      { id:'dr14',name:'Dr. Amanda Harris',department:'Pediatrics',specialization:'Pediatric Cardiology' },
      { id:'dr15',name:'Dr. Daniel Clark',department:'Pediatrics',specialization:'Neonatology' },
      { id:'dr16',name:'Dr. Jessica Lewis',department:'Pediatrics',specialization:'Pediatric Neurology' },
    ];
    const TIME_SLOTS=['09:00 AM','10:00 AM','11:00 AM','12:00 PM','02:00 PM','03:00 PM','04:00 PM','05:00 PM'];

    let currentPatient=null;
    let currentDoctor=null;
    let selectedDepartment='';
    let selectedDoctor='';
    let selectedDate='';
    let selectedTimeSlot='';

    function showToast(message,type='success'){
      const toast=document.createElement('div');
      toast.className=`toast ${type}`;
      toast.textContent=message;
      document.body.appendChild(toast);
      setTimeout(()=>toast.remove(),3000);
    }
    function getAppointments(){
      return JSON.parse(localStorage.getItem('appointments') || '[]');
    }
    function getTodayDate(){
      return new Date().toISOString().split('T')[0];
    }

    // Patient functions
    function initPatientDashboard(){
      document.getElementById('patient-dashboard').style.display='block';
      document.getElementById('patient-name').textContent=currentPatient.name;
      document.getElementById('patient-phone').textContent=currentPatient.phone;
      const deptGrid=document.getElementById('departments-grid');
      deptGrid.innerHTML='';
      DEPARTMENTS.forEach(dept=>{
        const btn=document.createElement('button');
        btn.className='department-btn';
        btn.textContent='ðŸ¥ '+dept;
        btn.onclick=()=>selectDepartment(dept);
        deptGrid.appendChild(btn);
      });
      loadPatientAppointments();
      const dateInput=document.getElementById('appointment-date');
      if(dateInput){dateInput.min=getTodayDate();}
    }

    function selectDepartment(dept){
      selectedDepartment=dept;
      selectedDoctor='';
      selectedDate='';
      selectedTimeSlot='';
      document.getElementById('step-2').style.display='block';
      document.getElementById('step-3').style.display='none';
      document.getElementById('step-4').style.display='none';
      document.getElementById('reset-btn').style.display='inline-block';
      const doctorsList=document.getElementById('doctors-list');
      doctorsList.innerHTML='';
      DOCTORS.filter(d=>d.department===dept).forEach(doctor=>{
        const btn=document.createElement('button');
        btn.className='doctor-btn';
        btn.innerHTML=`<strong>${doctor.name}</strong><br><small>${doctor.specialization}</small>`;
        btn.onclick=()=>selectDoctor(doctor.id);
        doctorsList.appendChild(btn);
      });
    }

    function selectDoctor(doctorId){
      selectedDoctor=doctorId;
      selectedDate='';
      selectedTimeSlot='';
      document.getElementById('step-3').style.display='block';
      document.getElementById('step-4').style.display='none';
      const dateInput=document.getElementById('appointment-date');
      dateInput.min=getTodayDate();
      dateInput.value='';
      dateInput.onchange=()=>selectDate(dateInput.value);
    }

    function selectDate(date){
      selectedDate=date;
      selectedTimeSlot='';
      document.getElementById('step-4').style.display='block';
      const slotsGrid=document.getElementById('time-slots-grid');
      slotsGrid.innerHTML='';
      TIME_SLOTS.forEach(slot=>{
        const btn=document.createElement('button');
        btn.className='time-slot-btn';
        btn.textContent='ðŸ• '+slot;
        const isBooked=getAppointments().some(a=>
          a.doctorId===selectedDoctor && a.date===selectedDate && a.timeSlot===slot
        );
        if(isBooked){
          btn.disabled=true;
          btn.textContent+=' (Booked)';
        }else{
          btn.onclick=(event)=>{
            selectTimeSlot(slot,event);
          };
        }
        slotsGrid.appendChild(btn);
      });
    }

    function selectTimeSlot(slot,ev){
      selectedTimeSlot=slot;
      document.querySelectorAll('.time-slot-btn').forEach(btn=>{
        btn.classList.remove('selected');
      });
      ev.target.classList.add('selected');
      document.getElementById('book-btn').style.display='inline-block';
    }

    function bookAppointment(){
      if(!selectedDoctor || !selectedDate || !selectedTimeSlot){
        showToast('Please complete all steps','error');
        return;
      }
      const appointments=getAppointments();
      const doctor=DOCTORS.find(d=>d.id===selectedDoctor);
      const appointment={
        id:'appt_'+Date.now(),
        patientId:currentPatient.id,
        patientName:currentPatient.name,
        patientPhone:currentPatient.phone,
        doctorId:doctor.id,
        doctorName:doctor.name,
        department:doctor.department,
        date:selectedDate,
        timeSlot:selectedTimeSlot
      };
      appointments.push(appointment);
      localStorage.setItem('appointments',JSON.stringify(appointments));
      showToast('Appointment booked successfully!');
      resetBooking();
      loadPatientAppointments();
    }

    function resetBooking(){
      selectedDepartment='';
      selectedDoctor='';
      selectedDate='';
      selectedTimeSlot='';
      document.getElementById('step-2').style.display='none';
      document.getElementById('step-3').style.display='none';
      document.getElementById('step-4').style.display='none';
      document.getElementById('book-btn').style.display='none';
      document.getElementById('reset-btn').style.display='none';
    }

    function loadPatientAppointments(){
      const appointments=getAppointments().filter(a=>a.patientId===currentPatient.id);
      const list=document.getElementById('appointments-list');
      if(appointments.length===0){
        list.innerHTML='<p style="text-align:center;color:#999;">No appointments yet. Book your first appointment!</p>';
        return;
      }
      list.innerHTML='';
      appointments.forEach(appt=>{
        const card=document.createElement('div');
        card.className='appointment-card';
        card.innerHTML=`
          <h3>${appt.doctorName}</h3>
          <p><strong>Department:</strong> ${appt.department}</p>
          <p><strong>Date:</strong> ${new Date(appt.date).toLocaleDateString()}</p>
          <p><strong>Time:</strong> ${appt.timeSlot}</p>
        `;
        list.appendChild(card);
      });
    }

    function logoutPatient(){
      localStorage.removeItem('currentPatient');
      window.location.href='patient-login.html';
    }

    // Doctor functions
    function initDoctorDashboard(){
      document.getElementById('doctor-dashboard').style.display='block';
      document.getElementById('doctor-name').textContent=currentDoctor.name;
      document.getElementById('doctor-dept').textContent=currentDoctor.department+' - '+currentDoctor.specialization;
      loadDoctorAppointments();
    }

    function loadDoctorAppointments(){
      const today=getTodayDate();
      const appointments=getAppointments().filter(a=>
        a.doctorId===currentDoctor.id && a.date===today
      );
      const tbody=document.getElementById('doctor-appointments-body');
      tbody.innerHTML='';
      TIME_SLOTS.forEach(slot=>{
        const appt=appointments.find(a=>a.timeSlot===slot);
        const row=document.createElement('tr');
        if(appt){
          row.innerHTML=`
            <td>${slot}</td>
            <td>${appt.patientName}</td>
            <td>${appt.patientPhone}</td>
            <td><span class="slot-booked">Booked</span></td>
          `;
        }else{
          row.innerHTML=`
            <td>${slot}</td>
            <td class="slot-empty">-</td>
            <td class="slot-empty">-</td>
            <td class="slot-empty">Available</td>
          `;
        }
        tbody.appendChild(row);
      });
    }

    function logoutDoctor(){
      localStorage.removeItem('currentDoctor');
      window.location.href='doctor-login.html';
    }

    // Init
    window.onload=function(){
      const savedPatient=localStorage.getItem('currentPatient');
      const savedDoctor=localStorage.getItem('currentDoctor');
      if(savedPatient){
        currentPatient=JSON.parse(savedPatient);
        initPatientDashboard();
      }
      if(savedDoctor){
        currentDoctor=JSON.parse(savedDoctor);
        initDoctorDashboard();
      }
      if(!savedPatient && !savedDoctor){
        // No one logged in, redirect to patient login
        window.location.href='patient-login.html';
      }
    };
  </script>
</body>
</html>